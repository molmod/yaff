
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>10. Trajectory Analysis &#8212; Yaff 1.4.2 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="11. Tuning force field parameters" href="ug_tune.html" />
    <link rel="prev" title="9. Exploring the phase space" href="ug_sampling.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ug_tune.html" title="11. Tuning force field parameters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ug_sampling.html" title="9. Exploring the phase space"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Yaff 1.4.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="trajectory-analysis">
<h1>10. Trajectory Analysis<a class="headerlink" href="#trajectory-analysis" title="Permalink to this headline">¶</a></h1>
<p>The analysis of the results is (in the first place) based on the HDF5 trajectory
output files. On-line analysis (during the iterative algorithm, without
writing data to disk) is also possible. As a final option, trajectory data
from other programs may also be converted to the HDF5 format used by Yaff, which
can then be post-processed as if it was generated by Yaff.</p>
<p>In all the examples below, the following import statement is implicitly
assumed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5py</span> <span class="k">as</span> <span class="nn">h5</span>
</pre></div>
</div>
<div class="section" id="slicing-the-data">
<h2>10.1. Slicing the data<a class="headerlink" href="#slicing-the-data" title="Permalink to this headline">¶</a></h2>
<p>All the analysis routines below have at least the following four optional
arguments:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">start</span></code>: the first sample to consider for the analysis</li>
<li><code class="docutils literal"><span class="pre">step</span></code>: consider only a sample each <code class="docutils literal"><span class="pre">step</span></code> iterations.</li>
<li><code class="docutils literal"><span class="pre">max_sample</span></code>: consider at most <code class="docutils literal"><span class="pre">max_sample</span></code> number of samples.</li>
</ul>
<p>Some routines also support the following optional argument:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">end</span></code>: the last sample to consider for the analysis.</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">max_sample</span></code> option is only possible when <code class="docutils literal"><span class="pre">step</span></code> is not specified and
the total number of samples (or <code class="docutils literal"><span class="pre">end</span></code>) is known. When <code class="docutils literal"><span class="pre">max_sample</span></code> is given,
the corresponding optimal value for <code class="docutils literal"><span class="pre">step</span></code> will be derived from
<code class="docutils literal"><span class="pre">max_sample</span></code>. Some analysis may not have the max_sample argument, e.g. the
spectrum analysis, because the choice of the step size for such analysis is a
critical parameter that needs to be set carefully.</p>
<p>See <a class="reference internal" href="rg_yaff_analysis.html#yaff.analysis.utils.get_slice" title="yaff.analysis.utils.get_slice"><code class="xref py py-func docutils literal"><span class="pre">yaff.analysis.utils.get_slice()</span></code></a> for the documentation of the generic
underlying routine that handles the slices.</p>
</div>
<div class="section" id="basic-analysis">
<h2>10.2. Basic analysis<a class="headerlink" href="#basic-analysis" title="Permalink to this headline">¶</a></h2>
<p>A few basic analysis routines are provided to quickly check the sanity of an MD
simulation:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">plot_energies</span></code> makes a plot of the kinetic and the total energy as function
of time. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;output.h5&#39;</span><span class="p">)</span>
<span class="n">plot_energies</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>makes a figure <code class="docutils literal"><span class="pre">energies.png</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">plot_temperate</span></code> and <code class="docutils literal"><span class="pre">plot_pressure</span></code> are similar, but they plot the
temperature and pressure as function of time instead of the energies.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">plot_temp_dist</span></code> plots the distribution (both pdf and cdf) of the
instantaneous atomic and system temperatures and compares these with the
expected analytical result for a constant-temperature ensemble. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;output.h5&#39;</span><span class="p">)</span>
<span class="n">plot_temp_dist</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>makes a figure <code class="docutils literal"><span class="pre">temp_dist.png</span></code></p>
</li>
</ul>
<p>All these functions accept optional arguments to tune their behavior. See
<a class="reference internal" href="rg_yaff_analysis.html#module-yaff.analysis.basic" title="yaff.analysis.basic"><code class="xref py py-mod docutils literal"><span class="pre">yaff.analysis.basic</span></code></a> for more analysis routines and more details.</p>
</div>
<div class="section" id="advanced-analysis">
<h2>10.3. Advanced analysis<a class="headerlink" href="#advanced-analysis" title="Permalink to this headline">¶</a></h2>
<p>Yaff also includes analysis tools that can extract relevant macroscopic
properties from a simulation. These analysis tools require some additional
computations that can either be done in a post-processing step, or on-line.</p>
<div class="section" id="radial-distribution-functions-rdfs">
<h3>10.3.1. Radial distribution functions (RDFs)<a class="headerlink" href="#radial-distribution-functions-rdfs" title="Permalink to this headline">¶</a></h3>
<p>The following example computes and oxygen-oxygen RDF using a previously
generated trajectory file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;output.h5&#39;</span><span class="p">)</span>
<span class="n">select</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">)</span> <span class="c1"># select atoms with ATSELECT rule</span>
<span class="n">rdf</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rcut</span><span class="o">=</span><span class="mf">4.8</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">rspacing</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">max_sample</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">select0</span><span class="o">=</span><span class="n">select</span><span class="p">)</span>
<span class="n">rdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">rdf</span><span class="o">.</span><span class="n">plot_crdf</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example, the cutoff for the RDF is 4.8 Å and the spacing of the
bins 0.1 Å. At most 100 samples are used to compute the RDF. The results are
included in the HDF5 file, and optionally plotted using matplotlib.
Alternatively, the same <code class="docutils literal"><span class="pre">RDFAnalysis</span></code> class can be used for on-line
analysis, without the need to store huge amounts of data on disk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
<span class="n">rdf</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">4.8</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">max_sample</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">select0</span><span class="o">=</span><span class="n">select</span><span class="p">)</span>
<span class="n">verlet</span> <span class="o">=</span> <span class="n">VerletIntegrator</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">rdf</span><span class="p">,</span> <span class="n">temp0</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">verlet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">rdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">rdf</span><span class="o">.</span><span class="n">plot_crdf</span><span class="p">()</span>
</pre></div>
</div>
<p>One may also construct RDFs based on two sets of particles, using two <code class="docutils literal"><span class="pre">select*</span></code>
arguments. The following example computes the inter-particle RDF for the oxygen
and hydrogen atoms, using a previously computed trajectory file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;output.h5&#39;</span><span class="p">)</span>
<span class="n">select0</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">)</span> <span class="c1"># select atoms with ATSELECT rule</span>
<span class="n">select1</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">rdf</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rcut</span><span class="o">=</span><span class="mf">4.8</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">rspacing</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">max_sample</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
          <span class="n">select0</span><span class="o">=</span><span class="n">select0</span><span class="p">,</span> <span class="n">select1</span><span class="o">=</span><span class="n">select1</span><span class="p">)</span>
<span class="n">rdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">rdf</span><span class="o">.</span><span class="n">plot_crdf</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The reference documentation of the <code class="docutils literal"><span class="pre">rdf</span></code> module (<a class="reference internal" href="rg_yaff_analysis.html#module-yaff.analysis.rdf" title="yaff.analysis.rdf"><code class="xref py py-mod docutils literal"><span class="pre">yaff.analysis.rdf</span></code></a>)
describes also the more exotic RDF options, e.g. to exclude intra-molecular
distances from the RDF.</p>
</div>
<div class="section" id="vibrational-spectra-and-correlation-times">
<h3>10.3.2. Vibrational spectra and correlation times<a class="headerlink" href="#vibrational-spectra-and-correlation-times" title="Permalink to this headline">¶</a></h3>
<p>The (efficient) computation of vibrational spectra and autocorrelation
functions are so closely related that they are carried out simultaneously. A
basic vibrational spectrum (by default based on the atomic velocities) is done
as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bsize</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_ac</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">bsize</span></code> argument determines the size of the blocks used for the
spectral analysis. The trajectory is cut into blocks of the given size. For
each block, the spectrum is computed, and then averaged over all blocks. The
<code class="docutils literal"><span class="pre">plot</span></code> method makes a figure of the spectrum. The <code class="docutils literal"><span class="pre">plot_ac</span></code> method makes
a figure of the corresponding autocorrelation function. All the results are
also available as attributes of the spectrum object. Similar to the RDF
analysis, the spectrum can be computed both on-line and off-line. One can
also estimate the IR spectrum as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bsize</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;trajectory/dipole_vel&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;ir&#39;</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>More details can be found in the reference documention:
<a class="reference internal" href="rg_yaff_analysis.html#module-yaff.analysis.spectrum" title="yaff.analysis.spectrum"><code class="xref py py-mod docutils literal"><span class="pre">yaff.analysis.spectrum</span></code></a>.</p>
</div>
<div class="section" id="diffusion-constants">
<h3>10.3.3. Diffusion constants<a class="headerlink" href="#diffusion-constants" title="Permalink to this headline">¶</a></h3>
<p>The diffusion constant (based on the displacements of all nuclei) is computed
as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="n">Diffusion</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">diff</span><span class="o">.</span><span class="n">A</span>
<span class="n">diff</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The positions are subsampled with step size of 10. The <code class="docutils literal"><span class="pre">mult</span></code> argument controls
between which time intervals are used to compute the mean-square displacements
(MSDs) used to carry out a fit of the Einstein diffusion equation. When set to
5, the MSDs are computed at intervals of 10, 20, 30, 40 and 50 steps. As soon
as the analysis is ready, a straight line is fitted through the MSD versus time
data. The slope (<code class="docutils literal"><span class="pre">diff.A</span></code>) of this line corresponds to the diffusion constant.
A plot of these data and the fitted line can be made with <code class="docutils literal"><span class="pre">diff.plot()</span></code>.</p>
<p>One may restrict the analysis to just a selection of atoms as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="n">Diffusion</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="rg_yaff_analysis.html#module-yaff.analysis.diffusion" title="yaff.analysis.diffusion"><code class="xref py py-mod docutils literal"><span class="pre">yaff.analysis.diffusion</span></code></a> for more details.</p>
<p><strong>TODO.</strong> Explain (and double check) how to compute diffusion constants of
multiple molecules instead of just atoms.</p>
</div>
<div class="section" id="computing-errors-on-thermodynamic-averages">
<h3>10.3.4. Computing errors on thermodynamic averages<a class="headerlink" href="#computing-errors-on-thermodynamic-averages" title="Permalink to this headline">¶</a></h3>
<p>The block average method can be used to compute the error on time-dependent
data that have some degree of auto-correlation. The following example computes
the error on the average temperature from an MD simulation, using a HDF5
trajectory file.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;output.h5&#39;</span><span class="p">)</span>
<span class="n">error</span><span class="p">,</span> <span class="n">sinef</span> <span class="o">=</span> <span class="n">blav</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;trajectory/temperature&#39;</span><span class="p">])</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Two values are returned. <code class="docutils literal"><span class="pre">error</span></code> is the error on the average. <code class="docutils literal"><span class="pre">sinef</span></code> is the
statistical sampling inefficiency. More details about this routine are given
here: <code class="xref py py-mod docutils literal"><span class="pre">yaff.sampling.blav</span></code>.</p>
</div>
</div>
<div class="section" id="post-processing-external-trajectory-data">
<h2>10.4. Post-processing external trajectory data<a class="headerlink" href="#post-processing-external-trajectory-data" title="Permalink to this headline">¶</a></h2>
<p>One may also use the analysis module of Yaff to process trajectories generated
with other molecular simulation codes. The following example script (see
<code class="docutils literal"><span class="pre">data/examples/002_external_trajectory/rdf.py</span></code>) converts the xyz file to HDF5 data,
which is then used to perform the analysis</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Needed for python2 backward compatibility</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="c1"># Import Yaff and Numpy libraries and setup a reference system. The reference</span>
<span class="c1"># system is used to recognize atom types etc.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">yaff</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">,</span> <span class="n">rvecs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mf">20.3</span><span class="p">,</span> <span class="mf">20.3</span><span class="p">,</span> <span class="mf">20.3</span><span class="p">])</span><span class="o">*</span><span class="n">angstrom</span><span class="p">)</span>

<span class="c1"># Create a HDF5 file and convert the XYZ file to arrays in the HDF5 file</span>
<span class="kn">import</span> <span class="nn">h5py</span> <span class="k">as</span> <span class="nn">h5</span>
<span class="k">with</span>  <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;trajectory.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">system</span><span class="o">.</span><span class="n">to_hdf5</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">xyz_to_hdf5</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>

    <span class="c1"># Select two lists of atom indexes based on the ATSELECT rules &#39;1&#39; and &#39;8&#39;</span>
    <span class="n">select0</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
    <span class="n">select1</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>

    <span class="c1"># Note. The remainder of the example may be moved to a separate script if</span>
    <span class="c1"># that would be more convenient, e.g. in case different RDFs must be generated.</span>
    <span class="c1"># This would avoid repetetive conversion of the XYZ file.</span>

    <span class="c1"># Create the RDF.</span>
    <span class="n">rdf</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">max_sample</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">select0</span><span class="o">=</span><span class="n">select0</span><span class="p">,</span> <span class="n">select1</span><span class="o">=</span><span class="n">select1</span><span class="p">)</span>
    <span class="c1"># One may make plots with the rdf object ...</span>
    <span class="n">rdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="c1"># ... or access the results as Numpy arrays</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RDF DATA FOR THE X-AXIS [A]&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">angstrom</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RDF DATA FOR THE Y-AXIS&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)</span>
</pre></div>
</div>
<p>See <code class="xref py py-mod docutils literal"><span class="pre">yaff.conversion</span></code> for more routines to convert trajectory data.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">10. Trajectory Analysis</a><ul>
<li><a class="reference internal" href="#slicing-the-data">10.1. Slicing the data</a></li>
<li><a class="reference internal" href="#basic-analysis">10.2. Basic analysis</a></li>
<li><a class="reference internal" href="#advanced-analysis">10.3. Advanced analysis</a><ul>
<li><a class="reference internal" href="#radial-distribution-functions-rdfs">10.3.1. Radial distribution functions (RDFs)</a></li>
<li><a class="reference internal" href="#vibrational-spectra-and-correlation-times">10.3.2. Vibrational spectra and correlation times</a></li>
<li><a class="reference internal" href="#diffusion-constants">10.3.3. Diffusion constants</a></li>
<li><a class="reference internal" href="#computing-errors-on-thermodynamic-averages">10.3.4. Computing errors on thermodynamic averages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#post-processing-external-trajectory-data">10.4. Post-processing external trajectory data</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ug_sampling.html"
                        title="previous chapter">9. Exploring the phase space</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ug_tune.html"
                        title="next chapter">11. Tuning force field parameters</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ug_analysis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ug_tune.html" title="11. Tuning force field parameters"
             >next</a> |</li>
        <li class="right" >
          <a href="ug_sampling.html" title="9. Exploring the phase space"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Yaff 1.4.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011, Toon Verstraelen, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>